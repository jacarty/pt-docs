<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Penetration Testing Sales Mastery</title>
    <style>
        /* CSS Reset and Variables */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #0066CC;
            --success-color: #00AA44;
            --warning-color: #FF6600;
            --accent-color: #00CCCC;
            --text-primary: #333;
            --text-secondary: #666;
            --text-light: #999;
            --bg-primary: #FFFFFF;
            --bg-secondary: #F5F5F5;
            --bg-dark: #2C3E50;
            --border-color: #E0E0E0;
            --shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            --shadow-hover: 0 4px 16px rgba(0, 0, 0, 0.15);
            --transition: all 0.3s ease;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: var(--text-primary);
            background-color: var(--bg-secondary);
            line-height: 1.6;
        }

        /* Header Styles */
        .header {
            background-color: var(--bg-primary);
            box-shadow: var(--shadow);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: var(--primary-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        /* Progress Bar */
        .progress-container {
            flex: 1;
            max-width: 400px;
            margin: 0 2rem;
        }

        .progress-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.25rem;
        }

        .progress-bar {
            height: 8px;
            background-color: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color) 0%, var(--accent-color) 100%);
            border-radius: 4px;
            transition: width 0.5s ease;
            width: 0%;
        }

        /* Timer Display */
        .timer-display {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background-color: var(--bg-secondary);
            border-radius: 8px;
            font-weight: 500;
        }

        /* Main Container */
        .main-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 6rem 2rem 2rem;
            min-height: 100vh;
        }

        /* Module Grid */
        .module-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .module-card {
            background-color: var(--bg-primary);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .module-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
        }

        .module-card.completed {
            border: 2px solid var(--success-color);
        }

        .module-card.completed::after {
            content: '✓';
            position: absolute;
            top: 1rem;
            right: 1rem;
            width: 32px;
            height: 32px;
            background-color: var(--success-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .module-icon {
            width: 48px;
            height: 48px;
            background-color: var(--bg-secondary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }

        .module-number {
            position: absolute;
            top: 1rem;
            left: 1rem;
            width: 28px;
            height: 28px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.875rem;
        }

        .module-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .module-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .module-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            color: var(--text-light);
        }

        /* Stats Dashboard */
        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background-color: var(--bg-primary);
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-top: 0.25rem;
        }

        /* Achievement Popup */
        .achievement-popup {
            position: fixed;
            top: 5rem;
            right: 2rem;
            background-color: var(--success-color);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            box-shadow: var(--shadow-hover);
            transform: translateX(400px);
            transition: transform 0.5s ease;
            z-index: 2000;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .achievement-popup.show {
            transform: translateX(0);
        }

        /* Module Content */
        .module-content {
            display: none;
            background-color: var(--bg-primary);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }

        .module-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .module-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }

        .close-button {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 4px;
            transition: var(--transition);
        }

        .close-button:hover {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
        }

        /* Navigation Buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid var(--border-color);
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background-color: #0052A3;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: var(--bg-secondary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background-color: var(--border-color);
        }

        /* Interactive Elements */
        .driver-card, .persona-card, .compliance-card, .testing-card, .objection-card {
            background-color: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 1.5rem;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 1rem;
        }

        .driver-card:hover, .persona-card:hover, .compliance-card:hover, .testing-card:hover, .objection-card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-hover);
            border-color: var(--primary-color);
        }

        .driver-card.active, .persona-card.active, .compliance-card.active, .testing-card.active, .objection-card.active {
            border-color: var(--primary-color);
            background-color: var(--bg-secondary);
        }

        .quiz-option {
            background-color: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .quiz-option:hover {
            border-color: var(--primary-color);
            transform: translateX(4px);
        }

        .quiz-option.correct {
            border-color: var(--success-color);
            background-color: rgba(0, 170, 68, 0.05);
        }

        .quiz-option.incorrect {
            border-color: #dc3545;
            background-color: rgba(220, 53, 69, 0.05);
        }

        .practice-option {
            background-color: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .practice-option:hover {
            border-color: var(--primary-color);
            transform: translateX(4px);
        }

        .practice-option.correct {
            border-color: var(--success-color);
            background-color: rgba(0, 170, 68, 0.05);
        }

        .practice-option.incorrect {
            border-color: #dc3545;
            background-color: rgba(220, 53, 69, 0.05);
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <div class="logo-icon">🎯</div>
                <span>PenTest Sales Mastery</span>
            </div>
            
            <div class="progress-container">
                <div class="progress-label">Overall Progress</div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
            </div>
            
            <div class="timer-display">
                <span>⏱️</span>
                <span id="timerDisplay">00:00</span>
            </div>
        </div>
    </header>

    <!-- Achievement Popup -->
    <div class="achievement-popup" id="achievementPopup">
        <span style="font-size: 1.5rem;">🏆</span>
        <div>
            <div id="achievementTitle">Achievement Unlocked!</div>
            <div id="achievementDescription" style="font-size: 0.875rem; opacity: 0.9;"></div>
        </div>
    </div>

    <!-- Main Container -->
    <main class="main-container">
        <!-- Stats Dashboard -->
        <div class="stats-dashboard" id="statsDashboard">
            <div class="stat-card">
                <div class="stat-value" id="modulesCompleted">0/5</div>
                <div class="stat-label">Modules Completed</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="totalTime">0m</div>
                <div class="stat-label">Total Time</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="accuracyRate">0%</div>
                <div class="stat-label">Accuracy Rate</div>
            </div>
            <div class="stat-card">
                <div class="stat-value" id="badgesEarned">0</div>
                <div class="stat-label">Badges Earned</div>
            </div>
        </div>

        <!-- Module Selection -->
        <div id="moduleSelection">
            <h1 style="text-align: center; margin-bottom: 2rem;">Choose Your Learning Module</h1>
            
            <div class="module-grid">
                <!-- Module 1: Business Value -->
                <div class="module-card" onclick="startModule(1)">
                    <div class="module-number">1</div>
                    <div class="module-icon">💰</div>
                    <h3 class="module-title">Business Value Mastery</h3>
                    <p class="module-description">Master ROI conversations and articulate the £4.88M breach cost story that closes deals</p>
                    <div class="module-meta">
                        <span>⏱️ 6 minutes</span>
                        <span id="status-1">Not Started</span>
                    </div>
                </div>

                <!-- Module 2: Buyer Personas -->
                <div class="module-card" onclick="startModule(2)">
                    <div class="module-number">2</div>
                    <div class="module-icon">👥</div>
                    <h3 class="module-title">Buyer Persona Navigator</h3>
                    <p class="module-description">Tailor your penetration testing pitch to CISOs, Compliance Officers, IT Directors, and CFOs</p>
                    <div class="module-meta">
                        <span>⏱️ 6 minutes</span>
                        <span id="status-2">Not Started</span>
                    </div>
                </div>

                <!-- Module 3: Compliance -->
                <div class="module-card" onclick="startModule(3)">
                    <div class="module-number">3</div>
                    <div class="module-icon">📋</div>
                    <h3 class="module-title">Compliance Compass</h3>
                    <p class="module-description">Navigate PCI-DSS, GDPR, HIPAA requirements and turn compliance into urgency</p>
                    <div class="module-meta">
                        <span>⏱️ 6 minutes</span>
                        <span id="status-3">Not Started</span>
                    </div>
                </div>

                <!-- Module 4: Technical -->
                <div class="module-card" onclick="startModule(4)">
                    <div class="module-number">4</div>
                    <div class="module-icon">🔍</div>
                    <h3 class="module-title">Technical Translator</h3>
                    <p class="module-description">Convert OWASP Top 10 and testing types into business impact stories</p>
                    <div class="module-meta">
                        <span>⏱️ 6 minutes</span>
                        <span id="status-4">Not Started</span>
                    </div>
                </div>

                <!-- Module 5: Objections -->
                <div class="module-card" onclick="startModule(5)">
                    <div class="module-number">5</div>
                    <div class="module-icon">🛡️</div>
                    <h3 class="module-title">Objection Eliminator</h3>
                    <p class="module-description">Turn "too expensive" and "no time" into "can't afford not to"</p>
                    <div class="module-meta">
                        <span>⏱️ 6 minutes</span>
                        <span id="status-5">Not Started</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Module Content Area -->
        <div class="module-content" id="moduleContent">
            <div class="module-header">
                <h2 id="moduleTitle">
                    <span id="moduleTitleIcon">💰</span>
                    <span id="moduleTitleText">Module Title</span>
                </h2>
                <button class="close-button" onclick="closeModule()">✕</button>
            </div>
            
            <div id="moduleContentArea">
                <!-- Dynamic content will be loaded here -->
            </div>
            
            <div class="nav-buttons">
                <button class="btn btn-secondary" onclick="previousSection()">
                    <span>←</span> Previous
                </button>
                <button class="btn btn-primary" onclick="nextSection()">
                    Next <span>→</span>
                </button>
            </div>
        </div>
    </main>

    <script>
        // Global State Management
        const appState = {
            currentModule: null,
            currentSection: 0,
            modules: {
                1: { title: 'Business Value Mastery', icon: '💰', completed: false, score: 0, time: 0 },
                2: { title: 'Buyer Persona Navigator', icon: '👥', completed: false, score: 0, time: 0 },
                3: { title: 'Compliance Compass', icon: '📋', completed: false, score: 0, time: 0 },
                4: { title: 'Technical Translator', icon: '🔍', completed: false, score: 0, time: 0 },
                5: { title: 'Objection Eliminator', icon: '🛡️', completed: false, score: 0, time: 0 }
            },
            totalTime: 0,
            badges: [],
            startTime: null
        };

        // Load saved state from localStorage
        function loadState() {
            const savedState = localStorage.getItem('pentestCourseState');
            if (savedState) {
                try {
                    const parsed = JSON.parse(savedState);
                    Object.assign(appState, parsed);
                } catch (e) {
                    console.warn('Failed to load saved state:', e);
                }
            }
            updateUI();
        }

        // Save state to localStorage
        function saveState() {
            try {
                localStorage.setItem('pentestCourseState', JSON.stringify(appState));
            } catch (e) {
                console.warn('Failed to save state:', e);
            }
        }

        // Update UI based on current state
        function updateUI() {
            // Update progress bar
            const completedModules = Object.values(appState.modules).filter(m => m.completed).length;
            const progressPercentage = (completedModules / 5) * 100;
            document.getElementById('progressBar').style.width = `${progressPercentage}%`;
            
            // Update stats
            document.getElementById('modulesCompleted').textContent = `${completedModules}/5`;
            document.getElementById('totalTime').textContent = `${Math.floor(appState.totalTime / 60)}m`;
            document.getElementById('badgesEarned').textContent = appState.badges.length;
            
            // Calculate accuracy
            const scores = Object.values(appState.modules).filter(m => m.score > 0);
            const avgAccuracy = scores.length > 0 
                ? Math.round(scores.reduce((sum, m) => sum + m.score, 0) / scores.length)
                : 0;
            document.getElementById('accuracyRate').textContent = `${avgAccuracy}%`;
            
            // Update module cards
            Object.keys(appState.modules).forEach(moduleId => {
                const module = appState.modules[moduleId];
                const statusElement = document.getElementById(`status-${moduleId}`);
                const cardElement = document.querySelector(`.module-card:nth-child(${moduleId})`);
                
                if (statusElement) {
                    if (module.completed) {
                        statusElement.textContent = 'Completed';
                        statusElement.style.color = 'var(--success-color)';
                        if (cardElement) cardElement.classList.add('completed');
                    } else if (module.score > 0) {
                        statusElement.textContent = 'In Progress';
                        statusElement.style.color = 'var(--warning-color)';
                    }
                }
            });
        }

        // Timer functionality
        let timerInterval;
        function startTimer() {
            appState.startTime = Date.now();
            timerInterval = setInterval(() => {
                const elapsed = Math.floor((Date.now() - appState.startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('timerDisplay').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                const elapsed = Math.floor((Date.now() - appState.startTime) / 1000);
                if (appState.currentModule) {
                    appState.modules[appState.currentModule].time += elapsed;
                    appState.totalTime += elapsed;
                    saveState();
                }
            }
        }

        // Module navigation
        function startModule(moduleId) {
            appState.currentModule = moduleId;
            appState.currentSection = 0;
            
            // Hide module selection, show content
            document.getElementById('moduleSelection').style.display = 'none';
            document.getElementById('statsDashboard').style.display = 'none';
            document.getElementById('moduleContent').classList.add('active');
            
            // Update module header
            const module = appState.modules[moduleId];
            document.getElementById('moduleTitleIcon').textContent = module.icon;
            document.getElementById('moduleTitleText').textContent = module.title;
            
            // Load module content
            loadModuleContent(moduleId);
            
            // Start timer
            startTimer();
        }

        function closeModule() {
            stopTimer();
            
            // Show module selection, hide content
            document.getElementById('moduleSelection').style.display = 'block';
            document.getElementById('statsDashboard').style.display = 'grid';
            document.getElementById('moduleContent').classList.remove('active');
            
            appState.currentModule = null;
            updateUI();
        }

        // Helper Functions for Module Content
        function getBusinessDriversHTML() {
            const drivers = [
                {
                    id: 'risk',
                    icon: '🎯',
                    title: 'Risk Management',
                    content: {
                        pitch: "Penetration testing identifies vulnerabilities before criminals do.",
                        stat: "Attackers exploit vulnerabilities within 5 days of discovery (vs 63 days in 2018)",
                        impact: "Proactive testing costs £500 per fix vs £500,000+ post-breach"
                    }
                },
                {
                    id: 'compliance',
                    icon: '📋',
                    title: 'Regulatory Compliance',
                    content: {
                        pitch: "Avoid fines and demonstrate due diligence to regulators.",
                        stat: "GDPR fines up to £17.5M or 4% of global turnover",
                        examples: "BA fined £20M, Marriott £18.4M for data breaches"
                    }
                },
                {
                    id: 'trust',
                    icon: '🤝',
                    title: 'Customer Trust',
                    content: {
                        pitch: "Security assessments are increasingly required before signing B2B contracts.",
                        stat: "43% customer loss after a breach",
                        impact: "Strong security = competitive advantage"
                    }
                },
                {
                    id: 'cost',
                    icon: '💰',
                    title: 'Cost Savings',
                    content: {
                        pitch: "A £50k test prevents a £4.88M breach = 9,660% ROI",
                        stat: "Average breach costs £4.53M in UK",
                        insurance: "15-25% premium reductions with regular testing"
                    }
                },
                {
                    id: 'competitive',
                    icon: '🚀',
                    title: 'Competitive Edge',
                    content: {
                        pitch: "Turn security into a business enabler, not a cost center.",
                        benefit: "Win enterprise contracts requiring security validation",
                        reality: "Security-mature companies grow 2.4x faster"
                    }
                }
            ];

            return drivers.map(driver => `
                <div class="driver-card" onclick="toggleCard(this, 'driver-${driver.id}')">
                    <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">${driver.icon}</div>
                    <h4 style="margin-bottom: 0.5rem;">${driver.title}</h4>
                    <div id="driver-${driver.id}-content" style="display: none; margin-top: 1rem; font-size: 0.875rem; color: var(--text-secondary);">
                        ${Object.entries(driver.content).map(([key, value]) => 
                            `<p style="margin-bottom: 0.5rem;"><strong>${key.charAt(0).toUpperCase() + key.slice(1)}:</strong> ${value}</p>`
                        ).join('')}
                    </div>
                </div>
            `).join('');
        }

        function getPracticeOptionsHTML() {
            const options = [
                { letter: 'A', text: 'Customer Trust - "Your customers expect security validation"', correct: false },
                { letter: 'B', text: 'Cost Savings - "74% of large UK businesses were breached last year. A £50k test provides 9,660% ROI by preventing just one £4.88M breach"', correct: true },
                { letter: 'C', text: 'Competitive Edge - "Security helps you grow faster"', correct: false },
                { letter: 'D', text: 'Risk Management - "Find vulnerabilities before attackers do"', correct: false }
            ];

            return options.map((option, index) => `
                <div class="practice-option" onclick="checkPractice(this, ${option.correct})">
                    <span style="width: 32px; height: 32px; background-color: var(--bg-secondary); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold;">${option.letter}</span>
                    ${option.text}
                </div>
            `).join('');
        }

        function getPersonasHTML() {
            return `
                <div class="driver-card">
                    <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">🛡️</div>
                    <h4>CISO / Security Leader</h4>
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                        Focuses on risk visibility, governance, and demonstrating security ROI to the board.
                    </p>
                </div>
                <div class="driver-card">
                    <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">📋</div>
                    <h4>Compliance Officer</h4>
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                        Needs audit-ready documentation and evidence of regulatory compliance.
                    </p>
                </div>
                <div class="driver-card">
                    <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">💻</div>
                    <h4>IT Director</h4>
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                        Requires technical validation and clear remediation guidance with minimal disruption.
                    </p>
                </div>
                <div class="driver-card">
                    <div style="font-size: 2.5rem; margin-bottom: 0.5rem;">💰</div>
                    <h4>CFO / Business Leader</h4>
                    <p style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                        Focuses on ROI quantification and financial risk in measurable terms.
                    </p>
                </div>
            `;
        }

        // Module Content Structure
        const moduleContent = {
            1: { // Business Value Mastery
                sections: [
                    {
                        type: 'intro',
                        title: 'Why Penetration Testing Matters',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                                <h3 style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1.5rem;">The £4.88 Million Question</h3>
                                <p style="font-size: 1.125rem; line-height: 1.8; margin-bottom: 1rem;">What if I told you that a single security breach costs UK businesses an average of <strong>£4.53 million</strong>?</p>
                                <p style="font-size: 1.125rem; line-height: 1.8; margin-bottom: 1rem;">And that <strong>74% of large UK businesses</strong> experienced a breach last year?</p>
                                <p style="font-size: 1.125rem; line-height: 1.8; margin-bottom: 2rem;">In the next 5 minutes, you'll master how to turn these statistics into compelling conversations that close deals.</p>
                                <div style="background-color: var(--bg-secondary); border-left: 4px solid var(--primary-color); padding: 1.5rem; margin: 2rem 0; display: flex; align-items: center; gap: 1rem; border-radius: 8px;">
                                    <div style="font-size: 2rem;">💡</div>
                                    <div style="text-align: left;">
                                        <strong>Your Goal:</strong> Transform security from a "nice-to-have" into a "must-have-now" business imperative.
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'interactive',
                        title: 'The 5 Business Drivers',
                        render: () => `
                            <div style="max-width: 1000px; margin: 0 auto;">
                                <h3 style="text-align: center; margin-bottom: 1rem;">Master the R.I.S.K.+ Framework</h3>
                                <p style="text-align: center; margin-bottom: 2rem;">Click each driver to understand how to position it:</p>
                                <div id="driversGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                    ${getBusinessDriversHTML()}
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'practice',
                        title: 'Apply Your Knowledge',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto;">
                                <h3>Scenario Practice</h3>
                                <div style="background-color: var(--bg-secondary); border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0;">
                                    <p><strong>Scenario:</strong> You're speaking with a CFO who says, "We've never been breached, so why spend money on penetration testing?"</p>
                                    <p>Which business driver would be MOST effective?</p>
                                </div>
                                <div id="practiceOptions">
                                    ${getPracticeOptionsHTML()}
                                </div>
                                <div id="practiceFeedback" style="display: none; background-color: var(--bg-secondary); border-radius: 8px; padding: 1.5rem; margin-top: 1.5rem; border-left: 4px solid var(--primary-color);"></div>
                            </div>
                        `
                    },
                    {
                        type: 'quiz',
                        title: 'Quick Assessment',
                        render: () => `<div id="quizContainer"></div>`
                    },
                    {
                        type: 'summary',
                        title: 'Your Action Plan',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto;">
                                <h3 style="color: var(--primary-color); margin-bottom: 1.5rem;">🎯 Key Takeaways</h3>
                                <div style="display: grid; gap: 1rem; margin-bottom: 2rem;">
                                    <div style="display: flex; align-items: flex-start; gap: 1rem; background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
                                        <span style="font-size: 1.5rem;">1️⃣</span>
                                        <div>
                                            <strong>Lead with Impact:</strong> "74% of large UK businesses were breached last year"
                                        </div>
                                    </div>
                                    <div style="display: flex; align-items: flex-start; gap: 1rem; background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
                                        <span style="font-size: 1.5rem;">2️⃣</span>
                                        <div>
                                            <strong>Quantify ROI:</strong> £50k investment prevents £4.53M breach = 9,660% ROI
                                        </div>
                                    </div>
                                    <div style="display: flex; align-items: flex-start; gap: 1rem; background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
                                        <span style="font-size: 1.5rem;">3️⃣</span>
                                        <div>
                                            <strong>Create Urgency:</strong> Attackers exploit vulnerabilities in 5 days (not 63)
                                        </div>
                                    </div>
                                    <div style="display: flex; align-items: flex-start; gap: 1rem; background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
                                        <span style="font-size: 1.5rem;">4️⃣</span>
                                        <div>
                                            <strong>Match Driver to Buyer:</strong> CFO = Cost, CISO = Risk, Compliance = Regulations
                                        </div>
                                    </div>
                                </div>
                            </div>
                        `
                    }
                ],
                questions: [
                    {
                        question: "A prospect in financial services says they're worried about operational disruption. What's your response?",
                        options: [
                            "Penetration testing is completely non-disruptive",
                            "95% of tests have zero business impact. We use controlled approaches and can test during off-hours",
                            "The disruption is worth the security benefits",
                            "We can skip the risky tests"
                        ],
                        correct: 1,
                        explanation: "Acknowledge the concern while providing data. 95% of tests cause no disruption, and controlled approaches ensure business continuity."
                    },
                    {
                        question: "What's the average cost of a data breach for UK businesses?",
                        options: [
                            "£1.2 million",
                            "£2.8 million", 
                            "£4.53 million",
                            "£6.7 million"
                        ],
                        correct: 2,
                        explanation: "£4.53 million is the UK average, with the global average at £4.88 million. This creates compelling ROI for testing investments."
                    },
                    {
                        question: "A healthcare client needs penetration testing. Which compliance driver is becoming mandatory in 2025?",
                        options: [
                            "PCI-DSS v4.0",
                            "HIPAA proposed rules requiring annual testing",
                            "SOC 2 Type II", 
                            "ISO 27001"
                        ],
                        correct: 1,
                        explanation: "HIPAA's proposed rule changes (January 2025) will make annual penetration testing mandatory for covered entities and business associates."
                    }
                ]
            },
            2: { // Buyer Personas
                sections: [
                    {
                        type: 'intro',
                        title: 'Know Your Buyer, Win the Deal',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                                <h3 style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1.5rem;">One Size Doesn't Fit All</h3>
                                <p style="font-size: 1.125rem; line-height: 1.8;">A CISO cares about <strong>risk reduction</strong>. A CFO focuses on <strong>financial impact</strong>. A Compliance Officer needs <strong>audit evidence</strong>.</p>
                                <p style="font-size: 1.125rem; line-height: 1.8; margin-bottom: 2rem;">Master how to tailor your penetration testing conversation to each key decision maker.</p>
                                <div style="background-color: var(--bg-secondary); border-left: 4px solid var(--primary-color); padding: 1.5rem; margin: 2rem 0; display: flex; align-items: center; gap: 1rem; border-radius: 8px;">
                                    <div style="font-size: 2rem;">🎯</div>
                                    <div style="text-align: left;">
                                        <strong>Your Goal:</strong> Match the right message to the right buyer for maximum impact.
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'interactive',
                        title: 'The 4 Key Buyer Personas',
                        render: () => `
                            <div style="max-width: 1000px; margin: 0 auto;">
                                <h3 style="text-align: center; margin-bottom: 1rem;">Meet Your Buyers</h3>
                                <p style="text-align: center; margin-bottom: 2rem;">Each persona has different motivations and pain points:</p>
                                <div id="personaGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
                                    ${getPersonasHTML()}
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'quiz',
                        title: 'Quick Assessment',
                        render: () => `<div id="quizContainer"></div>`
                    },
                    {
                        type: 'summary',
                        title: 'Your Persona Playbook',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto;">
                                <h3 style="color: var(--primary-color); margin-bottom: 1.5rem;">🎯 Quick Reference Guide</h3>
                                <div style="background-color: var(--bg-secondary); padding: 1.5rem; border-radius: 8px;">
                                    <h4>Remember: Match your message to their motivation</h4>
                                    <ul style="list-style: none; padding: 0; margin-top: 1rem;">
                                        <li style="margin-bottom: 0.5rem;">🛡️ <strong>CISO:</strong> Risk reduction and governance</li>
                                        <li style="margin-bottom: 0.5rem;">📋 <strong>Compliance:</strong> Audit evidence and regulations</li>
                                        <li style="margin-bottom: 0.5rem;">💻 <strong>IT Director:</strong> Technical validation and remediation</li>
                                        <li>💰 <strong>CFO:</strong> Financial impact and ROI</li>
                                    </ul>
                                </div>
                            </div>
                        `
                    }
                ],
                questions: [
                    {
                        question: "You're meeting with a CISO who mentions 'vendor consolidation pressure.' How do you position penetration testing?",
                        options: [
                            "As a standalone best-in-class solution",
                            "As part of your integrated security platform that reduces vendor sprawl",
                            "By criticizing their current vendors",
                            "By offering the lowest price"
                        ],
                        correct: 1,
                        explanation: "CISOs face pressure to reduce vendors. Position penetration testing as part of an integrated platform that simplifies their security stack."
                    },
                    {
                        question: "A Compliance Officer asks about GDPR requirements. What's the most compelling point?",
                        options: [
                            "GDPR doesn't specifically require penetration testing",
                            "You might get away without testing",
                            "Article 32 requires 'regular testing' of security measures, and BA was fined £20M",
                            "Focus on other compliance frameworks instead"
                        ],
                        correct: 2,
                        explanation: "While GDPR doesn't explicitly say 'penetration testing,' Article 32's requirement for regular testing is widely interpreted as including it. Real fines make this tangible."
                    }
                ]
            },
            3: { // Compliance
                sections: [
                    {
                        type: 'intro',
                        title: 'Navigate Compliance with Confidence',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                                <h3 style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1.5rem;">Turn Compliance into Urgency</h3>
                                <p style="font-size: 1.125rem; line-height: 1.8;">When you mention <strong>£17.5 million GDPR fines</strong> or <strong>PCI-DSS payment processing suspension</strong>, deals move faster.</p>
                                <p style="font-size: 1.125rem; line-height: 1.8; margin-bottom: 2rem;">Master the compliance frameworks that create immediate buying triggers.</p>
                                <div style="background-color: var(--bg-secondary); border-left: 4px solid var(--primary-color); padding: 1.5rem; margin: 2rem 0; display: flex; align-items: center; gap: 1rem; border-radius: 8px;">
                                    <div style="font-size: 2rem;">⚖️</div>
                                    <div style="text-align: left;">
                                        <strong>Your Goal:</strong> Position penetration testing as essential compliance insurance, not optional security enhancement.
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'summary',
                        title: 'Key Compliance Frameworks',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto;">
                                <h3 style="color: var(--primary-color); margin-bottom: 1.5rem;">⚖️ The Big 5 Frameworks</h3>
                                <div style="display: grid; gap: 1rem;">
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                                        <strong>PCI-DSS:</strong> Mandatory annual testing. v4.0 (March 2025) expands requirements significantly.
                                    </div>
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                                        <strong>GDPR:</strong> Article 32 requires "regular testing." BA fined £20M for breach.
                                    </div>
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                                        <strong>HIPAA:</strong> Proposed 2025 rules will make testing mandatory for all covered entities.
                                    </div>
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                                        <strong>SOC 2:</strong> Not mandatory but auditors expect it. Qualified reports hurt business.
                                    </div>
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                                        <strong>ISO 27001:</strong> Controls A.8.7 and A.8.29 require security testing validation.
                                    </div>
                                </div>
                            </div>
                        `
                    }
                ],
                questions: [
                    {
                        question: "A retail client processes credit cards. They say 'We passed our last PCI audit without penetration testing.' Your response?",
                        options: [
                            "That's great, you don't need testing then",
                            "PCI-DSS v4.0 is mandatory from March 2025 and expands requirements - you'll fail without testing",
                            "You should do it anyway for best practice", 
                            "Let's focus on other compliance frameworks"
                        ],
                        correct: 1,
                        explanation: "PCI-DSS v4.0 significantly expands requirements. Emphasize the mandatory nature and upcoming deadline to create urgency."
                    }
                ]
            },
            4: { // Technical
                sections: [
                    {
                        type: 'intro',
                        title: 'Speak Their Language',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                                <h3 style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1.5rem;">From Technical Jargon to Business Impact</h3>
                                <p style="font-size: 1.125rem; line-height: 1.8;">Your prospect doesn't care about <strong>CVSS scores</strong>. They care about <strong>customer data theft</strong>.</p>
                                <p style="font-size: 1.125rem; line-height: 1.8; margin-bottom: 2rem;">Master the art of translating technical vulnerabilities into business consequences that motivate action.</p>
                                <div style="background-color: var(--bg-secondary); border-left: 4px solid var(--primary-color); padding: 1.5rem; margin: 2rem 0; display: flex; align-items: center; gap: 1rem; border-radius: 8px;">
                                    <div style="font-size: 2rem;">🔄</div>
                                    <div style="text-align: left;">
                                        <strong>Your Goal:</strong> Make technical concepts accessible and actionable for non-technical buyers.
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'summary',
                        title: 'Technical Translation Guide',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto;">
                                <h3 style="color: var(--primary-color); margin-bottom: 1.5rem;">🔄 Business Impact Translation</h3>
                                <div style="display: grid; gap: 1rem;">
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
                                        <strong>Instead of:</strong> "SQL injection vulnerability"<br>
                                        <strong>Say:</strong> "Attackers could steal your entire customer database"
                                    </div>
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
                                        <strong>Instead of:</strong> "Broken authentication"<br>
                                        <strong>Say:</strong> "Anyone could log in as your CEO"
                                    </div>
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px;">
                                        <strong>Instead of:</strong> "Security misconfiguration"<br>
                                        <strong>Say:</strong> "Your data is publicly accessible on Google"
                                    </div>
                                </div>
                            </div>
                        `
                    }
                ],
                questions: [
                    {
                        question: "A non-technical CEO asks: 'What's the difference between vulnerability scanning and penetration testing?' Your response?",
                        options: [
                            "Scanning uses automated tools while testing is manual",
                            "Scanning is like listing all unlocked doors; testing actually tries to break in and shows what could be stolen",
                            "They're basically the same thing",
                            "Penetration testing is more expensive"
                        ],
                        correct: 1,
                        explanation: "Use analogies that business leaders understand. The unlocked door vs. actual break-in analogy clearly shows the value difference."
                    }
                ]
            },
            5: { // Objections
                sections: [
                    {
                        type: 'intro',
                        title: 'Turn Objections into Opportunities',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto; text-align: center;">
                                <h3 style="font-size: 2rem; color: var(--primary-color); margin-bottom: 1.5rem;">From "No" to "When Can We Start?"</h3>
                                <p style="font-size: 1.125rem; line-height: 1.8;">Every objection is a request for more information. Master the responses that turn <strong>skeptics into champions</strong>.</p>
                                <p style="font-size: 1.125rem; line-height: 1.8; margin-bottom: 2rem;">The top 6 objections kill 80% of deals. After this module, they'll accelerate yours.</p>
                                <div style="background-color: var(--bg-secondary); border-left: 4px solid var(--primary-color); padding: 1.5rem; margin: 2rem 0; display: flex; align-items: center; gap: 1rem; border-radius: 8px;">
                                    <div style="font-size: 2rem;">🛡️</div>
                                    <div style="text-align: left;">
                                        <strong>Your Goal:</strong> Welcome objections as opportunities to demonstrate value and build trust.
                                    </div>
                                </div>
                            </div>
                        `
                    },
                    {
                        type: 'summary',
                        title: 'The A.C.E. Framework',
                        render: () => `
                            <div style="max-width: 800px; margin: 0 auto;">
                                <h3 style="color: var(--primary-color); margin-bottom: 1.5rem;">🛡️ Master Objection Handling</h3>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 2rem;">
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-top: 3px solid var(--primary-color);">
                                        <strong style="color: var(--primary-color);">A - Acknowledge</strong>
                                        <p style="margin-top: 0.5rem; font-size: 0.875rem;">Show empathy and understanding. Never argue or dismiss their concern.</p>
                                    </div>
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-top: 3px solid var(--primary-color);">
                                        <strong style="color: var(--primary-color);">C - Clarify with Data</strong>
                                        <p style="margin-top: 0.5rem; font-size: 0.875rem;">Provide specific statistics and proof points that address their concern.</p>
                                    </div>
                                    <div style="background-color: var(--bg-secondary); padding: 1rem; border-radius: 8px; border-top: 3px solid var(--primary-color);">
                                        <strong style="color: var(--primary-color);">E - Engage Next Steps</strong>
                                        <p style="margin-top: 0.5rem; font-size: 0.875rem;">Move the conversation forward with a question or specific action.</p>
                                    </div>
                                </div>
                                <div style="background-color: rgba(0, 102, 204, 0.05); padding: 1.5rem; border-radius: 8px;">
                                    <h4 style="color: var(--primary-color); margin-bottom: 1rem;">🎯 Power Statistics</h4>
                                    <ul style="list-style: none; padding: 0; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.5rem;">
                                        <li><strong>£4.53M</strong> - Average UK breach cost</li>
                                        <li><strong>74%</strong> - Large UK businesses breached</li>
                                        <li><strong>9,660%</strong> - ROI on £50k preventing one breach</li>
                                        <li><strong>95%</strong> - Tests with zero disruption</li>
                                    </ul>
                                </div>
                            </div>
                        `
                    }
                ],
                questions: [
                    {
                        question: "A prospect says 'We had a bad experience - lots of false positives and a useless report.' What's your response?",
                        options: [
                            "Our reports are much better than that",
                            "I'm sorry you had that experience. What specific issues made it useless? We use multiple validation methods to eliminate false positives and provide actionable remediation guidance, not just problem lists.",
                            "That vendor must have been incompetent",
                            "Penetration testing has improved a lot recently"
                        ],
                        correct: 1,
                        explanation: "Acknowledge their experience, ask for specifics, then differentiate with concrete examples of how you solve those problems."
                    }
                ]
            }
        };

        // Interactive element functions
        function toggleCard(element, contentId) {
            const content = document.getElementById(contentId + '-content');
            if (!content) return;
            
            const isOpen = content.style.display === 'block';
            
            // Close all other cards of the same type
            const parent = element.parentElement;
            if (parent) {
                parent.querySelectorAll('[id$="-content"]').forEach(el => {
                    el.style.display = 'none';
                });
                parent.querySelectorAll('.driver-card, .persona-card, .compliance-card, .testing-card, .objection-card').forEach(el => {
                    el.classList.remove('active');
                });
            }
            
            // Toggle this card
            if (!isOpen) {
                content.style.display = 'block';
                element.classList.add('active');
            }
        }

        function checkPractice(element, isCorrect) {
            // Disable all options
            document.querySelectorAll('.practice-option').forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            // Mark selected answer
            if (isCorrect) {
                element.classList.add('correct');
            } else {
                element.classList.add('incorrect');
                // Find and highlight correct answer (B is correct)
                const options = document.querySelectorAll('.practice-option');
                if (options[1]) options[1].classList.add('correct');
            }
            
            // Show feedback
            const feedback = document.getElementById('practiceFeedback');
            if (feedback) {
                feedback.style.display = 'block';
                feedback.innerHTML = isCorrect ? 
                    '✅ <strong>Excellent!</strong> CFOs respond best to financial impact. The ROI calculation makes the decision obvious.' :
                    '❌ <strong>Good try!</strong> For CFOs, always lead with financial impact and ROI. The 9,660% return makes it a clear business decision.';
            }
        }

        // Quiz state
        let currentQuizQuestion = 0;
        let quizScore = 0;
        let quizAnswers = [];

        function loadModuleContent(moduleId) {
            const contentArea = document.getElementById('moduleContentArea');
            const module = moduleContent[moduleId];
            
            if (!module) {
                contentArea.innerHTML = `
                    <div style="text-align: center; padding: 4rem 0;">
                        <p>Module content not yet implemented.</p>
                    </div>
                `;
                return;
            }
            
            const section = module.sections[appState.currentSection];
            
            if (section.type === 'quiz') {
                loadQuizSection(module.questions);
            } else {
                contentArea.innerHTML = section.render();
            }
            
            updateNavigationButtons();
        }

        function loadQuizSection(questions) {
            currentQuizQuestion = 0;
            quizScore = 0;
            quizAnswers = [];
            
            const container = document.getElementById('quizContainer');
            if (!container) return;
            
            container.innerHTML = `
                <div style="max-width: 800px; margin: 0 auto;">
                    <h3>Quick Assessment</h3>
                    <div style="background-color: var(--border-color); height: 12px; border-radius: 6px; overflow: hidden; margin: 1.5rem 0;">
                        <div id="quizProgress" style="height: 100%; background: linear-gradient(90deg, var(--primary-color) 0%, var(--accent-color) 100%); transition: width 0.5s ease; width: 0%;"></div>
                    </div>
                    <p style="text-align: center; color: var(--text-secondary); font-size: 0.875rem;">Question <span id="currentQuestion">1</span> of ${questions.length}</p>
                    <div id="quizContent"></div>
                </div>
            `;
            
            loadQuizQuestion(questions[currentQuizQuestion]);
        }

        function loadQuizQuestion(question) {
            const quizContent = document.getElementById('quizContent');
            if (!quizContent) return;
            
            quizContent.innerHTML = `
                <div style="background-color: var(--bg-secondary); border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0;">
                    <h4>${question.question}</h4>
                </div>
                <div id="quizOptions">
                    ${question.options.map((option, index) => `
                        <div class="quiz-option" onclick="selectQuizAnswer(${index}, ${question.correct === index})">
                            <span style="margin-right: 1rem; font-weight: bold;">${String.fromCharCode(65 + index)}</span>
                            ${option}
                        </div>
                    `).join('')}
                </div>
                <div id="quizFeedback" style="display: none; background-color: var(--bg-secondary); border-radius: 8px; padding: 1.5rem; margin-top: 1.5rem; border-left: 4px solid var(--primary-color);">
                    <p></p>
                    <button class="btn btn-primary" style="margin-top: 1rem;" onclick="nextQuizQuestion()">
                        Next Question →
                    </button>
                </div>
            `;
        }

        function selectQuizAnswer(index, isCorrect) {
            // Disable all options
            document.querySelectorAll('.quiz-option').forEach(opt => {
                opt.style.pointerEvents = 'none';
            });
            
            // Mark selected answer
            const selectedOption = document.querySelectorAll('.quiz-option')[index];
            const questions = moduleContent[appState.currentModule].questions;
            const currentQ = questions[currentQuizQuestion];
            
            if (isCorrect) {
                selectedOption.classList.add('correct');
                quizScore++;
            } else {
                selectedOption.classList.add('incorrect');
                // Show correct answer
                const correctOption = document.querySelectorAll('.quiz-option')[currentQ.correct];
                if (correctOption) correctOption.classList.add('correct');
            }
            
            // Show feedback
            const feedback = document.getElementById('quizFeedback');
            if (feedback) {
                const feedbackText = feedback.querySelector('p');
                if (feedbackText) {
                    feedbackText.innerHTML = `
                        <strong>${isCorrect ? '✅ Correct!' : '❌ Not quite.'}</strong><br>
                        ${currentQ.explanation}
                    `;
                }
                feedback.style.display = 'block';
            }
            
            // Store answer
            quizAnswers.push({
                question: currentQuizQuestion,
                selected: index,
                correct: isCorrect
            });
        }

        function nextQuizQuestion() {
            const questions = moduleContent[appState.currentModule].questions;
            currentQuizQuestion++;
            
            if (currentQuizQuestion < questions.length) {
                // Update progress
                const progress = ((currentQuizQuestion) / questions.length) * 100;
                const progressEl = document.getElementById('quizProgress');
                const currentQuestionEl = document.getElementById('currentQuestion');
                
                if (progressEl) progressEl.style.width = `${progress}%`;
                if (currentQuestionEl) currentQuestionEl.textContent = currentQuizQuestion + 1;
                
                // Load next question
                loadQuizQuestion(questions[currentQuizQuestion]);
            } else {
                // Quiz complete
                showQuizResults();
            }
        }

        function showQuizResults() {
            const questions = moduleContent[appState.currentModule].questions;
            const percentage = Math.round((quizScore / questions.length) * 100);
            
            // Store score
            appState.modules[appState.currentModule].score = percentage;
            
            const quizContent = document.getElementById('quizContent');
            if (quizContent) {
                quizContent.innerHTML = `
                    <div style="text-align: center; padding: 2rem 0;">
                        <h3>Assessment Complete!</h3>
                        <div style="width: 200px; height: 200px; border-radius: 50%; background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%); display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 2rem auto; color: white; box-shadow: var(--shadow-hover);">
                            <div style="font-size: 3rem; font-weight: 700;">${percentage}%</div>
                            <div style="font-size: 0.875rem; opacity: 0.9;">${quizScore} of ${questions.length} correct</div>
                        </div>
                        ${percentage === 100 ? '<p style="color: var(--success-color); font-weight: 500; font-size: 1.125rem;">🎉 Perfect score! You\'ve mastered this content!</p>' : 
                          percentage >= 70 ? '<p style="color: var(--success-color); font-weight: 500; font-size: 1.125rem;">✅ Great job! You\'re ready to move on.</p>' :
                          '<p style="color: var(--warning-color); font-weight: 500; font-size: 1.125rem;">Keep practicing! Review the content and try again.</p>'}
                        <button class="btn btn-primary" style="margin-top: 2rem;" onclick="nextSection()">
                            Continue →
                        </button>
                    </div>
                `;
            }
            
            // Check for achievements
            if (percentage === 100) {
                unlockAchievement('Perfect Score', 'Achieved 100% on a module assessment!');
            }
            if (appState.modules[appState.currentModule].time < 300) { // Under 5 minutes
                unlockAchievement('Speed Learner', 'Completed a module in under 5 minutes!');
            }
        }

        function updateNavigationButtons() {
            const prevBtn = document.querySelector('.btn-secondary');
            const nextBtn = document.querySelector('.btn-primary');
            const sections = moduleContent[appState.currentModule]?.sections || [];
            
            // Previous button
            if (prevBtn) {
                prevBtn.style.display = appState.currentSection === 0 ? 'none' : 'flex';
            }
            
            // Next button
            if (nextBtn) {
                if (appState.currentSection === sections.length - 1) {
                    nextBtn.innerHTML = 'Complete Module <span>✓</span>';
                    nextBtn.onclick = completeModule;
                } else {
                    nextBtn.innerHTML = 'Next <span>→</span>';
                    nextBtn.onclick = nextSection;
                }
            }
        }

        function previousSection() {
            if (appState.currentSection > 0) {
                appState.currentSection--;
                loadModuleContent(appState.currentModule);
            }
        }

        function nextSection() {
            const sections = moduleContent[appState.currentModule]?.sections || [];
            if (appState.currentSection < sections.length - 1) {
                appState.currentSection++;
                loadModuleContent(appState.currentModule);
            }
        }

        function completeModule() {
            // Mark module as completed
            if (appState.currentModule) {
                appState.modules[appState.currentModule].completed = true;
            }
            
            // Check for course completion
            const completedCount = Object.values(appState.modules).filter(m => m.completed).length;
            if (completedCount === 5) {
                unlockAchievement('Course Complete', 'Completed all 5 modules!');
            }
            
            // Check for first try achievement
            if (quizAnswers.every(a => a.correct)) {
                unlockAchievement('First Try Hero', 'Passed module assessment on first attempt!');
            }
            
            // Save and close
            saveState();
            closeModule();
        }

        // Achievement system
        function unlockAchievement(title, description) {
            const popup = document.getElementById('achievementPopup');
            const titleEl = document.getElementById('achievementTitle');
            const descEl = document.getElementById('achievementDescription');
            
            if (titleEl) titleEl.textContent = title;
            if (descEl) descEl.textContent = description;
            
            if (popup) {
                popup.classList.add('show');
                setTimeout(() => {
                    popup.classList.remove('show');
                }, 3000);
            }
            
            // Add to badges if not already earned
            if (!appState.badges.includes(title)) {
                appState.badges.push(title);
                saveState();
                updateUI();
            }
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            loadState();
        });

        // Save state before page unload
        window.addEventListener('beforeunload', () => {
            if (appState.currentModule) {
                stopTimer();
            }
        });
    </script>
</body>
</html>